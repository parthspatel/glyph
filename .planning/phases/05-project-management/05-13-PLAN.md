---
phase: 05-project-management
plan: 13
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/api/src/routes/project_types.rs
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Skill requirements can be added to project types via POST /api/v1/project-types/{id}/skills"
    - "Skill requirements can be removed from project types via DELETE /api/v1/project-types/{id}/skills/{skill_id}"
  artifacts:
    - path: "apps/api/src/routes/project_types.rs"
      provides: "Skill requirement endpoints wired to PgProjectTypeRepository"
      contains: "repo.add_skill_requirement"
  key_links:
    - from: "apps/api/src/routes/project_types.rs::add_skill_requirement"
      to: "libs/db/src/repo/pg_project_type.rs::add_skill_requirement"
      via: "PgProjectTypeRepository method call"
      pattern: "repo\\.add_skill_requirement"
---

<objective>
Wire skill requirement API routes to PgProjectTypeRepository skill methods.

Purpose: The add_skill_requirement and remove_skill_requirement methods are implemented in PgProjectTypeRepository but routes return 404.
Output: Working skill requirement management endpoints.
</objective>

<context>
Reference files:
- libs/db/src/repo/pg_project_type.rs (has add_skill_requirement, remove_skill_requirement methods)
- apps/api/src/routes/project_types.rs (routes to wire)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Wire add_skill_requirement and remove_skill_requirement routes</name>
  <files>apps/api/src/routes/project_types.rs</files>
  <action>
1. Wire add_skill_requirement:
   - Add Extension(pool) parameter
   - Build SkillRequirement from request
   - Call repo.add_skill_requirement()
   - Return 201 on success

2. Wire remove_skill_requirement:
   - Add Extension(pool) parameter  
   - Call repo.remove_skill_requirement()
   - Return 204 on success, 404 if not found

Note: parse_proficiency helper function should already exist from plan 05-12.
  </action>
  <verify>
    Run `cargo check -p glyph-api` - no errors
    Test manually:
    - Create project type, then POST skill requirement -> 201
    - DELETE skill requirement -> 204
    - DELETE again -> 404
  </verify>
  <done>
    Skill requirement endpoints work:
    - POST /api/v1/project-types/{id}/skills adds requirement and returns 201
    - DELETE /api/v1/project-types/{id}/skills/{skill_id} removes and returns 204
  </done>
</task>

</tasks>

<verification>
1. `cargo build -p glyph-api` compiles
2. Create project type, add skill requirement, verify in GET response
3. Remove skill requirement, verify removed in GET response
</verification>

<success_criteria>
- Both skill requirement routes connect to repository methods
- Proper error handling (404 for missing project type or skill)
- Returns correct status codes (201 for add, 204 for remove)
</success_criteria>

<output>
After completion, create `.planning/phases/05-project-management/05-13-SUMMARY.md`
</output>

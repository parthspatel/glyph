---
phase: 05.1-ux-navigation-flow
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/components/layout/AppSidebar.tsx
autonomous: true

must_haves:
  truths:
    - "Project-scoped actions appear in sidebar when viewing a project"
    - "Project-scoped section disappears when navigating away from project"
    - "Active state shows correct item within project context"
  artifacts:
    - path: "apps/web/src/components/layout/AppSidebar.tsx"
      provides: "Conditional project-scoped navigation section"
      contains: "projectId"
  key_links:
    - from: "apps/web/src/components/layout/AppSidebar.tsx"
      to: "useParams"
      via: "React Router params"
      pattern: "useParams.*projectId"
    - from: "apps/web/src/components/layout/AppSidebar.tsx"
      to: "Project routes"
      via: "Link components"
      pattern: "/projects/.*projectId"
---

<objective>
Add a project-scoped navigation section to the sidebar that appears when viewing any project page, providing quick access to project-specific actions.

Purpose: When users are viewing a project, they need easy access to project-specific pages (Overview, Settings, Tasks) without returning to the projects list. This contextual navigation improves UX for project-focused workflows.
Output: Conditional SidebarGroup that renders project actions when URL matches `/projects/:projectId/*`.
</objective>

<execution_context>
@/Users/parthpatel/.claude/get-shit-done/workflows/execute-plan.md
@/Users/parthpatel/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@apps/web/src/components/layout/AppSidebar.tsx
@apps/web/src/pages/ProjectDetailPage.tsx
@.planning/phases/05.1-ux-navigation-flow/05.1-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add project-scoped sidebar section</name>
  <files>apps/web/src/components/layout/AppSidebar.tsx</files>
  <action>
Add a conditional SidebarGroup that appears when the user is viewing a project page.

1. Import useParams from react-router-dom (already imported as useLocation)
2. Import additional icons: FileText, Settings, ClipboardList (Settings may already be imported)
3. Detect project context using location and params:
```typescript
const params = useParams<{ projectId?: string }>();
const isProjectContext = location.pathname.startsWith('/projects/') && 
                         params.projectId && 
                         params.projectId !== 'new';
```

4. Add a new SidebarGroup after the main navigation group, conditionally rendered:
```typescript
{isProjectContext && (
  <SidebarGroup>
    <SidebarGroupLabel className="text-xs font-medium text-muted-foreground">
      Project
    </SidebarGroupLabel>
    <SidebarGroupContent>
      <SidebarMenu>
        <SidebarMenuItem>
          <SidebarMenuButton
            asChild
            isActive={location.pathname === `/projects/${params.projectId}`}
            tooltip="Overview"
            className={cn(
              location.pathname === `/projects/${params.projectId}` &&
                "border-l-2 border-primary bg-accent font-semibold"
            )}
          >
            <Link to={`/projects/${params.projectId}`}>
              <FileText className={cn(
                location.pathname === `/projects/${params.projectId}` && "text-primary"
              )} />
              <span>Overview</span>
            </Link>
          </SidebarMenuButton>
        </SidebarMenuItem>
        <SidebarMenuItem>
          <SidebarMenuButton
            asChild
            isActive={location.pathname === `/projects/${params.projectId}/edit`}
            tooltip="Settings"
            className={cn(
              location.pathname === `/projects/${params.projectId}/edit` &&
                "border-l-2 border-primary bg-accent font-semibold"
            )}
          >
            <Link to={`/projects/${params.projectId}/edit`}>
              <Settings className={cn(
                location.pathname === `/projects/${params.projectId}/edit` && "text-primary"
              )} />
              <span>Settings</span>
            </Link>
          </SidebarMenuButton>
        </SidebarMenuItem>
        <SidebarMenuItem>
          <SidebarMenuButton
            asChild
            isActive={location.pathname === `/projects/${params.projectId}/tasks`}
            tooltip="Tasks"
            className={cn(
              location.pathname === `/projects/${params.projectId}/tasks` &&
                "border-l-2 border-primary bg-accent font-semibold"
            )}
          >
            <Link to={`/projects/${params.projectId}/tasks`}>
              <ClipboardList className={cn(
                location.pathname === `/projects/${params.projectId}/tasks` && "text-primary"
              )} />
              <span>Tasks</span>
            </Link>
          </SidebarMenuButton>
        </SidebarMenuItem>
      </SidebarMenu>
    </SidebarGroupContent>
  </SidebarGroup>
)}
```

5. Ensure the section appears BELOW the main navigation group but ABOVE the footer.

6. The section should respect the hover-to-expand behavior already implemented - when sidebar is collapsed, hovering shows the section with full labels.

Note: Use the same active state styling as the main nav items (border-l-2, bg-accent, font-semibold) for consistency.
  </action>
  <verify>
1. Navigate to /projects - no project section in sidebar
2. Click on a project - "Project" section appears with Overview, Settings, Tasks
3. Current page (Overview) is highlighted with purple border
4. Click Settings - Settings becomes highlighted, Overview loses highlight
5. Navigate to /teams - project section disappears
6. Collapse sidebar, hover - project section shows with labels
  </verify>
  <done>
Project-scoped sidebar section renders conditionally based on route; active states work correctly; section respects hover-to-expand.
  </done>
</task>

<task type="auto">
  <name>Task 2: Extract project nav items to configuration</name>
  <files>apps/web/src/components/layout/AppSidebar.tsx</files>
  <action>
Refactor the hardcoded project nav items into a configuration array for maintainability (similar to the main navItems pattern).

At the top of the component or in a separate section:
```typescript
const projectNavItems = [
  { path: "", label: "Overview", icon: FileText },
  { path: "/edit", label: "Settings", icon: Settings },
  { path: "/tasks", label: "Tasks", icon: ClipboardList },
];
```

Then map over this array in the render:
```typescript
{isProjectContext && (
  <SidebarGroup>
    <SidebarGroupLabel className="text-xs font-medium text-muted-foreground">
      Project
    </SidebarGroupLabel>
    <SidebarGroupContent>
      <SidebarMenu>
        {projectNavItems.map((item) => {
          const fullPath = `/projects/${params.projectId}${item.path}`;
          const isItemActive = location.pathname === fullPath;
          return (
            <SidebarMenuItem key={item.path}>
              <SidebarMenuButton
                asChild
                isActive={isItemActive}
                tooltip={item.label}
                className={cn(
                  isItemActive && "border-l-2 border-primary bg-accent font-semibold"
                )}
              >
                <Link to={fullPath}>
                  <item.icon className={cn(isItemActive && "text-primary")} />
                  <span>{item.label}</span>
                </Link>
              </SidebarMenuButton>
            </SidebarMenuItem>
          );
        })}
      </SidebarMenu>
    </SidebarGroupContent>
  </SidebarGroup>
)}
```

This pattern makes it easy to add more project-scoped pages later (e.g., Data Sources, Activity).
  </action>
  <verify>
Same verification as Task 1 - behavior unchanged, code is more maintainable.
  </verify>
  <done>
Project nav items extracted to configuration array; same behavior, cleaner code.
  </done>
</task>

</tasks>

<verification>
1. Navigate to /projects - main nav only, no project section
2. Navigate to /projects/new - no project section (new project has no ID)
3. Navigate to /projects/:projectId - project section appears below main nav
4. Project section shows: Overview, Settings, Tasks
5. Active item has purple left border and bold text
6. Clicking between project pages updates active state
7. Navigating to non-project page removes project section
8. Collapsed sidebar hover shows project section with labels
9. Mobile view (if applicable) handles project section appropriately
</verification>

<success_criteria>
- Project section appears only when viewing a specific project (not /projects list, not /projects/new)
- Active states match main navigation styling (purple border, bg-accent)
- Section respects sidebar collapse/expand behavior
- No flicker or layout shift during navigation
- Code is maintainable with configuration-driven nav items
</success_criteria>

<output>
After completion, create `.planning/phases/05.1-ux-navigation-flow/05.1-03-SUMMARY.md`
</output>

---
phase: 05.1-ux-navigation-flow
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/hooks/useBreadcrumbs.ts
  - apps/web/src/lib/navigation.ts
autonomous: true

must_haves:
  truths:
    - "Breadcrumbs show project name (not ID) when viewing project pages"
    - "Route labels display friendly names for all project-related paths"
  artifacts:
    - path: "apps/web/src/hooks/useBreadcrumbs.ts"
      provides: "Cache lookup for project names"
      contains: "projects.*detail"
    - path: "apps/web/src/lib/navigation.ts"
      provides: "Route labels for project paths"
      contains: "project-types"
  key_links:
    - from: "apps/web/src/hooks/useBreadcrumbs.ts"
      to: "React Query cache"
      via: "getEntityName function"
      pattern: "projects.*detail"
---

<objective>
Fix breadcrumb cache lookup to correctly resolve project names from React Query cache, and add missing route labels for project-related paths.

Purpose: Breadcrumbs currently show "PROJ..." instead of actual project names because the cache lookup pattern doesn't match the query key used by useProject hook.
Output: Breadcrumbs display project names correctly; all project-related paths have friendly labels.
</objective>

<execution_context>
@/Users/parthpatel/.claude/get-shit-done/workflows/execute-plan.md
@/Users/parthpatel/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@apps/web/src/hooks/useBreadcrumbs.ts
@apps/web/src/hooks/useProjects.ts
@apps/web/src/lib/navigation.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix breadcrumb cache key pattern matching</name>
  <files>apps/web/src/hooks/useBreadcrumbs.ts</files>
  <action>
Update the `getEntityName` function in useBreadcrumbs.ts to handle the query key pattern used by useProjects hook.

Current useProject query key: `['projects', 'detail', id]` (from projectKeys.detail(id))
Current lookup patterns only check: `[type, id]` and `[type + 's', id]`

Add a new pattern that matches the actual query key structure:
```typescript
const patterns = [
  [type, id],                    // ['project', 'proj_123']
  [type + 's', id],              // ['projects', 'proj_123']
  [type + 's', 'detail', id],    // ['projects', 'detail', 'proj_123'] - MATCHES useProject
  [type, { id }],                // ['project', { id: 'proj_123' }]
];
```

Also add similar pattern for teams: `['teams', 'detail', id]` to maintain consistency.

The fix ensures that when useBreadcrumbs tries to resolve a projectId, it finds the cached project data and extracts the name.
  </action>
  <verify>
Navigate to `/projects/:projectId` after loading a project. Breadcrumb should show "Home / Projects / [Project Name]" instead of "Home / Projects / PROJ...".
  </verify>
  <done>
Breadcrumbs display actual project names from cache; "PROJ..." fallback only appears when cache is empty.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add missing route labels for project paths</name>
  <files>apps/web/src/lib/navigation.ts</files>
  <action>
Update the `routeLabels` object in navigation.ts to include labels for all project-related paths:

```typescript
export const routeLabels: Record<string, string> = {
  "": "Home",
  projects: "Projects",
  new: "New",
  edit: "Edit",
  teams: "Teams",
  admin: "Admin",
  users: "Users",
  tasks: "Tasks",
  annotate: "Annotate",
  settings: "Settings",
  // Add these new labels for Phase 5:
  "project-types": "Project Types",
  sources: "Data Sources",
  overview: "Overview",
};
```

This ensures breadcrumbs show "Project Types" instead of "Project-types" and other friendly labels for project-related sub-routes.
  </action>
  <verify>
Navigate to `/admin/project-types` (once created in Plan 02). Breadcrumb should show "Home / Admin / Project Types" with proper capitalization.
  </verify>
  <done>
All project-related route segments have friendly labels in breadcrumbs.
  </done>
</task>

</tasks>

<verification>
1. Navigate to `/projects` - breadcrumb shows "Home / Projects"
2. Click on a project - breadcrumb shows "Home / Projects / [Actual Project Name]"
3. Click Edit on project - breadcrumb shows "Home / Projects / [Project Name] / Edit"
4. Verify no console errors related to cache lookups
</verification>

<success_criteria>
- Breadcrumbs display project names (not IDs) when project data is cached
- Route labels are friendly for all project-related paths
- No regression in existing breadcrumb functionality (teams, users still work)
</success_criteria>

<output>
After completion, create `.planning/phases/05.1-ux-navigation-flow/05.1-01-SUMMARY.md`
</output>

---
phase: 09.2-project-overview-modules-ui
plan: 03
type: execute
wave: 2
depends_on: ["09.2-01"]
files_modified:
  - apps/web/src/components/project/modules/ProjectTypeModule.tsx
  - apps/web/src/components/project/modules/DeadlineModule.tsx
  - apps/web/src/components/project/modules/index.ts
autonomous: true

must_haves:
  truths:
    - "ProjectTypeModule shows current type name or empty state"
    - "Clicking ProjectTypeModule opens modal with type selector"
    - "DeadlineModule shows date and countdown or empty state"
    - "Clicking DeadlineModule opens modal with date picker"
    - "Saving in modal updates the project"
  artifacts:
    - path: "apps/web/src/components/project/modules/ProjectTypeModule.tsx"
      provides: "Project type display and edit module"
      exports: ["ProjectTypeModule"]
    - path: "apps/web/src/components/project/modules/DeadlineModule.tsx"
      provides: "Deadline display and edit module"
      exports: ["DeadlineModule"]
  key_links:
    - from: "ProjectTypeModule.tsx"
      to: "ModuleCard.tsx"
      via: "import ModuleCard"
      pattern: "import.*ModuleCard.*from"
    - from: "ProjectTypeModule.tsx"
      to: "useProjectTypes"
      via: "fetch available types"
      pattern: "useProjectTypes"
    - from: "DeadlineModule.tsx"
      to: "ModuleCard.tsx"
      via: "import ModuleCard"
      pattern: "import.*ModuleCard.*from"
---

<objective>
Create ProjectTypeModule and DeadlineModule - two modules that use modal edit pattern for simple configuration.

Purpose: These modules show preview content and open dialogs for quick edits without navigating away from the overview page.

Output: Two functional module components with modal edit dialogs.
</objective>

<context>
@.planning/PROJECT.md
@.planning/phases/09.2-project-overview-modules-ui/09.2-RESEARCH.md
@.planning/phases/09.2-project-overview-modules-ui/09.2-01-SUMMARY.md

@apps/web/src/components/project/modules/ModuleCard.tsx
@apps/web/src/components/ui/dialog.tsx
@apps/web/src/hooks/useProjectTypes.ts
@apps/web/src/hooks/useProjects.ts
@apps/web/src/api/projects.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ProjectTypeModule with modal selector</name>
  <files>
    apps/web/src/components/project/modules/ProjectTypeModule.tsx
    apps/web/src/components/project/modules/index.ts
  </files>
  <action>
Create ProjectTypeModule component:

```tsx
interface ProjectTypeModuleProps {
  projectId: string;
  projectTypeId: string | null;
  onUpdate: (typeId: string) => Promise<void>;
}
```

**Display (ModuleCard preview):**
- Icon: FileType from lucide-react
- Title: "Project Type"
- Configured: Show type name (fetch from useProjectTypes)
- Unconfigured: "No type selected" + "Select Type" action

**Modal (Dialog):**
- Title: "Select Project Type"
- Content: List/grid of project types from useProjectTypes()
- Each type shows: name, description (truncated), selection indicator
- Selected type highlighted with ring/border
- Footer: Cancel + Save buttons

**Data flow:**
1. Click card → open dialog
2. User selects type
3. Click Save → call onUpdate(selectedTypeId)
4. Close dialog, parent refetches project

**Use optimistic update pattern from research:**
```tsx
const mutation = useMutation({
  mutationFn: (typeId: string) => onUpdate(typeId),
  onMutate: async (newTypeId) => {
    // Optimistically update UI
  },
  onError: (err, newTypeId, context) => {
    // Rollback
  },
});
```

Add to barrel export.
  </action>
  <verify>
TypeScript compiles
Module renders with current type or empty state
Clicking opens modal with type list
Selecting type and saving calls onUpdate
  </verify>
  <done>
ProjectTypeModule displays type preview and opens modal for selection with save functionality.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create DeadlineModule with date picker modal</name>
  <files>
    apps/web/src/components/project/modules/DeadlineModule.tsx
    apps/web/src/components/project/modules/index.ts
  </files>
  <action>
Create DeadlineModule component:

```tsx
interface DeadlineModuleProps {
  projectId: string;
  deadline: string | null; // ISO date string
  deadlineAction?: 'notify' | 'pause' | 'escalate';
  onUpdate: (deadline: string | null, action?: string) => Promise<void>;
}
```

**Display (ModuleCard preview):**
- Icon: Calendar from lucide-react
- Title: "Deadline"
- Configured: Format date nicely + countdown ("Feb 28, 2026 • 23 days left")
  - Use `date-fns` for formatting: `format(date, 'MMM d, yyyy')`
  - Calculate days remaining: `differenceInDays(deadline, new Date())`
  - If past deadline, show in warning state with "X days overdue"
- Unconfigured: "No deadline set" + "Set Deadline" action

**Modal (Dialog):**
- Title: "Set Project Deadline"
- Content:
  1. Date input (type="date" or shadcn DatePicker if available)
  2. Deadline action select: "When deadline passes..."
     - notify: "Send notification"
     - pause: "Pause project"
     - escalate: "Escalate to admin"
  3. Option to clear deadline (if currently set)
- Footer: Cancel + Save buttons

**Countdown display helper:**
```tsx
function formatCountdown(deadline: Date): string {
  const days = differenceInDays(deadline, new Date());
  if (days < 0) return `${Math.abs(days)} days overdue`;
  if (days === 0) return 'Due today';
  if (days === 1) return '1 day left';
  return `${days} days left`;
}
```

Add to barrel export.
  </action>
  <verify>
TypeScript compiles
Module shows date and countdown for configured state
Shows empty state guidance when no deadline
Modal opens with date picker and action selector
Save updates deadline
  </verify>
  <done>
DeadlineModule displays deadline preview with countdown and opens modal for date/action configuration.
  </done>
</task>

</tasks>

<verification>
- `cd apps/web && pnpm exec tsc --noEmit` passes
- ProjectTypeModule renders and opens modal
- DeadlineModule renders with countdown calculation
- Both modules show proper empty states
- Modal saves call the onUpdate callback
- Warning state shows for overdue deadlines
</verification>

<success_criteria>
- ProjectTypeModule shows type name or "No type selected"
- DeadlineModule shows formatted date + countdown
- Both open modal dialogs on click
- Modals have proper Cancel/Save buttons
- Save callbacks execute successfully
- Components exported from modules/index.ts
</success_criteria>

<output>
After completion, create `.planning/phases/09.2-project-overview-modules-ui/09.2-03-SUMMARY.md`
</output>

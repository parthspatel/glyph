---
phase: 09.1-project-configuration-experience
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/components/workflow/Canvas/nodes/StartNode.tsx
  - apps/web/src/components/workflow/Canvas/nodes/EndNode.tsx
  - apps/web/src/components/workflow/Canvas/nodes/AnnotationNode.tsx
  - apps/web/src/components/workflow/Canvas/nodes/ReviewNode.tsx
  - apps/web/src/components/workflow/Canvas/nodes/AdjudicationNode.tsx
  - apps/web/src/components/workflow/Canvas/nodes/AutoProcessNode.tsx
  - apps/web/src/components/workflow/Canvas/nodes/ConditionNode.tsx
  - apps/web/src/components/workflow/Canvas/nodes/ForkNode.tsx
  - apps/web/src/components/workflow/Canvas/nodes/JoinNode.tsx
  - apps/web/src/components/workflow/Canvas/nodes/SubWorkflowNode.tsx
  - apps/web/src/components/workflow/Canvas/nodes/index.ts
  - apps/web/src/components/workflow/Canvas/edges/TransitionEdge.tsx
autonomous: true

must_haves:
  truths:
    - "Each node type has distinct visual appearance"
    - "Nodes show validation state (red badge when invalid)"
    - "Start node is filled black circle, End node is bullseye"
  artifacts:
    - path: "apps/web/src/components/workflow/Canvas/nodes/StartNode.tsx"
      provides: "Start node (filled black circle)"
      exports: ["StartNode"]
    - path: "apps/web/src/components/workflow/Canvas/nodes/AnnotationNode.tsx"
      provides: "Annotation step node"
      exports: ["AnnotationNode"]
    - path: "apps/web/src/components/workflow/Canvas/nodes/index.ts"
      provides: "Node type registry"
      exports: ["nodeTypes"]
  key_links:
    - from: "nodes/index.ts"
      to: "WorkflowCanvas.tsx"
      via: "nodeTypes prop"
      pattern: "nodeTypes="
---

<objective>
Create custom React Flow node components for all workflow step types with consistent styling and validation indicators.

Purpose: Visual nodes are the core of the workflow designer. Each step type needs distinct appearance and interaction affordances per CONTEXT.md decisions.

Output: Complete set of memoized node components ready for canvas integration.
</objective>

<execution_context>
@/Users/parthpatel/.claude/get-shit-done/workflows/execute-plan.md
@/Users/parthpatel/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/09.1-project-configuration-experience/09.1-CONTEXT.md
@libs/workflow-engine/src/config/types.rs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Start and End nodes (UML state diagram style)</name>
  <files>
apps/web/src/components/workflow/Canvas/nodes/StartNode.tsx
apps/web/src/components/workflow/Canvas/nodes/EndNode.tsx
apps/web/src/components/workflow/Canvas/nodes/BaseNode.tsx
  </files>
  <action>
Create BaseNode.tsx with shared node structure:
- Wrapper div with selection styling (ring when selected)
- Handle components for source/target connections
- Validation badge slot (top-right, shows red dot when hasError)
- onClick handler that calls canvasStore.selectNode

Create StartNode.tsx (per CONTEXT.md "filled black circle"):
- 40px diameter filled black circle
- "Start" label below
- Single source Handle on bottom
- No target Handle (entry point only)
- Memoize with React.memo

Create EndNode.tsx (per CONTEXT.md "bullseye"):
- 40px diameter with nested circles (outer ring + inner filled)
- Label shows outcome (data.label or "End")
- Single target Handle on top
- No source Handle (terminal state)
- Support multiple End nodes with different labels (Completed, Rejected, etc.)
- Memoize with React.memo
  </action>
  <verify>Nodes render with correct visual appearance</verify>
  <done>Start (filled circle) and End (bullseye) nodes created with handles</done>
</task>

<task type="auto">
  <name>Task 2: Create step type nodes (Annotation, Review, Adjudication, AutoProcess)</name>
  <files>
apps/web/src/components/workflow/Canvas/nodes/AnnotationNode.tsx
apps/web/src/components/workflow/Canvas/nodes/ReviewNode.tsx
apps/web/src/components/workflow/Canvas/nodes/AdjudicationNode.tsx
apps/web/src/components/workflow/Canvas/nodes/AutoProcessNode.tsx
  </files>
  <action>
Create consistent step node design:
- Rounded rectangle (w-48 min-h-16)
- Header bar with step type icon and name
- Body shows: assigned layout name (or "No layout"), key config summary
- Source Handle on bottom, Target Handle on top
- Validation badge in top-right corner (red dot when step has errors)
- Selected state: purple ring (matching project style guide)

AnnotationNode:
- Icon: Edit/Pencil
- Color accent: Blue
- Shows: layout name, required skills count

ReviewNode:
- Icon: Eye
- Color accent: Green
- Shows: layout name, "Show previous: Yes/No"

AdjudicationNode:
- Icon: Scale/Balance
- Color accent: Orange
- Shows: layout name, agreement threshold

AutoProcessNode:
- Icon: Cog/Gear
- Color accent: Gray
- Shows: processor type, "Automatic"

All nodes use React.memo and NodeProps<WorkflowNode> typing.
  </action>
  <verify>Each node type renders with distinct icon and color</verify>
  <done>Four step nodes created with consistent design and type-specific details</done>
</task>

<task type="auto">
  <name>Task 3: Create control flow nodes (Condition, Fork, Join, SubWorkflow) and edge</name>
  <files>
apps/web/src/components/workflow/Canvas/nodes/ConditionNode.tsx
apps/web/src/components/workflow/Canvas/nodes/ForkNode.tsx
apps/web/src/components/workflow/Canvas/nodes/JoinNode.tsx
apps/web/src/components/workflow/Canvas/nodes/SubWorkflowNode.tsx
apps/web/src/components/workflow/Canvas/nodes/index.ts
apps/web/src/components/workflow/Canvas/edges/TransitionEdge.tsx
  </files>
  <action>
ConditionNode:
- Diamond shape (rotated square)
- Icon: GitBranch
- Shows condition expression preview
- Multiple source Handles (one per branch)

ForkNode:
- Horizontal bar (split symbol)
- Icon: GitFork
- One target, multiple source Handles

JoinNode:
- Horizontal bar (merge symbol)
- Icon: GitMerge
- Multiple target, one source Handle
- Shows join mode: "All", "N of M", "First"

SubWorkflowNode:
- Rounded rectangle with dashed border
- Icon: Workflow/Layers
- Shows sub-workflow name
- Double-click hint: "Double-click to expand"
- Collapsed by default

Create index.ts with nodeTypes object:
```typescript
export const nodeTypes = {
  start: StartNode,
  end: EndNode,
  annotation: AnnotationNode,
  review: ReviewNode,
  adjudication: AdjudicationNode,
  auto_process: AutoProcessNode,
  condition: ConditionNode,
  fork: ForkNode,
  join: JoinNode,
  sub_workflow: SubWorkflowNode,
};
```

Create TransitionEdge.tsx:
- Custom edge with animated flow indicator
- Shows condition label if present
- Smooth step path type
- Deletable on selection
  </action>
  <verify>All node types render correctly, edges connect nodes</verify>
  <done>Complete nodeTypes registry and custom edge created</done>
</task>

</tasks>

<verification>
1. Import nodeTypes in WorkflowCanvas, all node types render
2. Each node has correct visual (icons, colors, shapes)
3. Handles allow connections between nodes
</verification>

<success_criteria>
- 10 node types created with distinct visuals
- Start = filled circle, End = bullseye
- Step nodes show layout name and key config
- Control nodes have appropriate shapes (diamond, bars)
- All nodes memoized for performance
</success_criteria>

<output>
After completion, create `.planning/phases/09.1-project-configuration-experience/09.1-02-SUMMARY.md`
</output>

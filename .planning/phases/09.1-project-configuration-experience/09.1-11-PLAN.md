---
phase: 09.1-project-configuration-experience
plan: 11
type: execute
wave: 6
depends_on: ["09.1-09", "09.1-10"]
files_modified:
  - apps/web/src/components/workflow/Activation/ActivationChecklist.tsx
  - apps/web/src/components/workflow/Activation/ChecklistItem.tsx
  - apps/web/src/components/workflow/Activation/useActivationValidation.ts
  - apps/api/src/routes/projects.rs
autonomous: true

must_haves:
  truths:
    - "Clicking Activate shows checklist modal"
    - "Blockers prevent activation"
    - "Success shows next steps"
  artifacts:
    - path: "apps/web/src/components/workflow/Activation/ActivationChecklist.tsx"
      provides: "Activation checklist modal"
      exports: ["ActivationChecklist"]
    - path: "apps/api/src/routes/projects.rs"
      provides: "Pre-activation validation endpoint"
      exports: ["validate_project_activation"]
  key_links:
    - from: "ActivationChecklist.tsx"
      to: "/api/v1/projects/{id}/validate-activation"
      via: "useQuery"
      pattern: "validate-activation"
---

<objective>
Create project activation checklist with validation and success flow.

Purpose: Per CONTEXT.md, clicking "Activate Project" shows a checklist modal organized by category with blockers first. Users can't activate until all blockers are resolved. Success shows next steps.

Output: Activation checklist modal with backend validation endpoint.
</objective>

<execution_context>
@/Users/parthpatel/.claude/get-shit-done/workflows/execute-plan.md
@/Users/parthpatel/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/09.1-project-configuration-experience/09.1-CONTEXT.md
@.planning/phases/09.1-project-configuration-experience/09.1-09-SUMMARY.md
@.planning/phases/09.1-project-configuration-experience/09.1-10-SUMMARY.md
@apps/api/src/routes/projects.rs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create backend validation endpoint</name>
  <files>
apps/api/src/routes/projects.rs
libs/domain/src/project.rs
  </files>
  <action>
Add validation endpoint to projects.rs:

```rust
#[utoipa::path(
    get,
    path = "/v1/projects/{project_id}/validate-activation",
    responses(
        (status = 200, body = ActivationValidationResponse)
    )
)]
pub async fn validate_project_activation(
    Path(project_id): Path<Uuid>,
    State(state): State<AppState>,
) -> Result<Json<ActivationValidationResponse>, AppError>
```

ActivationValidationResponse structure:
```rust
struct ActivationValidationResponse {
    can_activate: bool,
    checks: Vec<ActivationCheck>,
}

struct ActivationCheck {
    id: String,
    category: String,  // "workflow", "data_source", "layouts", "permissions"
    severity: String,  // "blocker", "warning", "passed"
    message: String,
    fix_action: Option<String>,  // Link to fix
}
```

Validation checks:
- Workflow: has_workflow, workflow_valid, has_start_node, has_end_node, all_reachable
- Data Source: has_data_source, data_source_connected, schema_valid
- Layouts: all_steps_have_layouts, layouts_published
- Permissions: has_team, team_has_members, roles_assigned

Register route in router.
  </action>
  <verify>GET /api/v1/projects/{id}/validate-activation returns checks</verify>
  <done>Validation endpoint returns categorized checks</done>
</task>

<task type="auto">
  <name>Task 2: Create ActivationChecklist modal</name>
  <files>
apps/web/src/components/workflow/Activation/ActivationChecklist.tsx
apps/web/src/components/workflow/Activation/ChecklistItem.tsx
apps/web/src/components/workflow/Activation/useActivationValidation.ts
apps/web/src/components/workflow/Activation/index.ts
  </files>
  <action>
Create useActivationValidation.ts hook:
- Fetch validation from /api/v1/projects/{id}/validate-activation
- Group checks by category
- Sort: blockers first, then warnings, then passed
- Expose: checks, canActivate, refetch

Create ChecklistItem.tsx:
- Icon based on severity:
  - blocker: red X (XCircle)
  - warning: yellow ! (AlertTriangle)
  - passed: green check (CheckCircle)
- Message text
- "Fix" link button if fix_action provided
- Click navigates to relevant section

Create ActivationChecklist.tsx (per CONTEXT.md "Modal on Activate"):
- Use Dialog from shadcn/ui
- Animated entrance (scale + fade)
- Header: "Activate Project" with project name
- Sections by category: Workflow, Data Source, Layouts, Permissions
- Each section shows ChecklistItems
- Footer:
  - "Activate" button (disabled if blockers exist)
  - "Cancel" button
- Auto-close when all blockers resolved? Or stay open per CONTEXT.md
- Show progress indicator while loading

Create index.ts barrel export.
  </action>
  <verify>Open checklist - see items grouped by category, blockers shown first</verify>
  <done>Checklist modal with categorized, prioritized items</done>
</task>

<task type="auto">
  <name>Task 3: Create success flow and integrate activation</name>
  <files>
apps/web/src/components/workflow/Activation/ActivationSuccess.tsx
apps/web/src/components/workflow/WorkflowDesigner.tsx
apps/web/src/pages/ProjectEditPage.tsx
  </files>
  <action>
Create ActivationSuccess.tsx (per CONTEXT.md):
- Celebratory modal with confetti animation (optional)
- "Project Activated!" message
- Next steps list:
  1. "Invite annotators to your team"
  2. "Monitor progress on dashboard"
  3. "Configure quality settings"
- "Go to Dashboard" primary button
- "Stay here" secondary button

Update activation flow:
1. User clicks "Activate Project"
2. Show ActivationChecklist
3. If blockers: show them, user fixes
4. User clicks "Activate" button
5. Show "Are you sure?" confirmation dialog (brief)
6. Call PUT /api/v1/projects/{id} with status: "active"
7. On success, show ActivationSuccess modal
8. On "Go to Dashboard", navigate to /projects/{id}

Update WorkflowDesigner.tsx:
- Add "Activate Project" button in header/toolbar
- Button shows current status
- Clicking opens ActivationChecklist

Update ProjectEditPage.tsx:
- Include activation button
- Pass project status to button
  </action>
  <verify>Complete activation flow - project status becomes "active"</verify>
  <done>Full activation flow with confirmation and success</done>
</task>

</tasks>

<verification>
1. Click "Activate Project" - checklist modal opens
2. Fix blocking issues - blocker items update
3. All blockers resolved - "Activate" button enables
4. Click "Activate" - confirmation dialog
5. Confirm - project activated, success modal shows
6. "Go to Dashboard" - navigates to project page
</verification>

<success_criteria>
- Validation endpoint returns categorized checks
- Checklist modal organized by category
- Blockers shown first with red X
- Click "Fix" navigates to relevant section
- "Activate" disabled until blockers resolved
- Success modal shows next steps
</success_criteria>

<output>
After completion, create `.planning/phases/09.1-project-configuration-experience/09.1-11-SUMMARY.md`
</output>
